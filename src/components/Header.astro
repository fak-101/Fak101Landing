---
import { getTranslations, t } from '../utils/i18n';

// Get current locale from Astro params
const lang = Astro.params?.lang ?? 'en';

// Load translations
const translations = await getTranslations(Astro, lang);
---
<!-- Main Header Component -->
<header id="main-header" class="hidden lg:block bg-[#F4F4F4] fixed top-0 left-0 right-0 z-50 transition-transform duration-300 ease-in-out">
  <!-- DESKTOP & MOBILE NAVIGATION BAR -->
  <nav aria-label="Global" class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8">
    
    <!-- LOGO/BRAND SECTION - Visible on all screen sizes -->
    <div class="flex lg:flex-1">
      <a href={`/${lang}/`} class="-m-1.5 p-1.5 hover-scale" data-animate="fadeInLeft">
        <span class="sr-only">{t(translations, 'meta.brandName')}</span>
        <div class="w-6 h-6 md:w-8 md:h-8 rounded-full bg-[#D60606] flex items-center justify-center"></div>
      </a>
    </div>

    <!-- DESKTOP NAVIGATION LINKS - Only visible on large screens -->
    <div class="hidden lg:flex lg:flex-1 lg:items-center lg:justify-end lg:gap-x-8" data-stagger>
      <a href={`/${lang}/#about`} class="nav-brackets text-base font-semibold text-gray-900 hover:text-gray-700 transition-colors" data-stagger-item data-animate="fadeInDown">
        <span class="bracket-left">[</span>
        <span class="nav-text">{t(translations, 'header.about')}</span>
        <span class="bracket-right">]</span>
      </a>
      <a href={`/${lang}/#services`} class="nav-brackets text-base font-semibold text-gray-900 hover:text-gray-700 transition-colors" data-stagger-item data-animate="fadeInDown">
        <span class="bracket-left">[</span>
        <span class="nav-text">{t(translations, 'header.services')}</span>
        <span class="bracket-right">]</span>
      </a>
      <a href={`/${lang}/#approach`} class="nav-brackets text-base font-semibold text-gray-900 hover:text-gray-700 transition-colors" data-stagger-item data-animate="fadeInDown">
        <span class="bracket-left">[</span>
        <span class="nav-text">{t(translations, 'header.approach')}</span>
        <span class="bracket-right">]</span>
      </a>
      <a href={`/${lang}/#projects`} class="nav-brackets text-base font-semibold text-gray-900 hover:text-gray-700 transition-colors" data-stagger-item data-animate="fadeInDown">
        <span class="bracket-left">[</span>
        <span class="nav-text">{t(translations, 'header.projects')}</span>
        <span class="bracket-right">]</span>
      </a>
    </div>
  </nav>
</header>

<style>
  .nav-brackets {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: gap 0.3s ease;
  }

  .nav-brackets .bracket-left,
  .nav-brackets .bracket-right {
    transition: transform 0.3s ease;
    display: inline-block;
  }

  .nav-text {
    font-family: var(--font-sans);
  }

  .nav-brackets:hover {
    gap: 0.35rem;
  }

  .nav-brackets:hover .bracket-left {
    transform: translateX(0.15rem);
  }

  .nav-brackets:hover .bracket-right {
    transform: translateX(-0.15rem);
  }
</style>

<script>
  (function() {
    const header = document.getElementById('main-header');
    if (!header) return;

    let lastScrollY = window.scrollY;
    let ticking = false;

    function updateHeader() {
      if (!header) return;
      
      const currentScrollY = window.scrollY;
      
      // Always show header at the top of the page
      if (currentScrollY <= 0) {
        header.style.transform = 'translateY(0)';
        lastScrollY = currentScrollY;
        ticking = false;
        return;
      }

      // Show header when scrolling up, hide when scrolling down
      if (currentScrollY > lastScrollY && currentScrollY > 100) {
        // Scrolling down - hide header
        header.style.transform = 'translateY(-100%)';
      } else if (currentScrollY < lastScrollY) {
        // Scrolling up - show header
        header.style.transform = 'translateY(0)';
      }

      lastScrollY = currentScrollY;
      ticking = false;
    }

    function onScroll() {
      if (!ticking) {
        window.requestAnimationFrame(updateHeader);
        ticking = true;
      }
    }

    window.addEventListener('scroll', onScroll, { passive: true });
  })();
</script>

